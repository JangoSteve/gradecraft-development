- @assignments.alphabetical.chronological.group_by(&:assignment_type).each do |assignment_type, assignments|
  .col-lg-12.col-xs-12.col-md-12.col-sm-12
    %button.btn.btn-success.col.col-xs-12.col-md-12.col-sm-12.col-lg-12{"data-target" => "#assignment_type-#{assignment_type.id}", "data-toggle" => "collapse"} #{assignment_type.try(:name)} #{ points current_student_data.score_for_assignment_type(assignment_type) }/#{points current_student_data.point_total_for_assignment_type(assignment_type)}
    .collapse{:id => "assignment_type-#{assignment_type.id}"}
      .col-lg-10
        - if assignment_type.predictor_description?
          = raw assignment_type.predictor_description
      - if assignment_type.student_weightable? && current_course.assignment_weight_open?
        .col-lg-2
          - if current_student_data.weighted_assignments?
            .badge.badge-primary= "#{current_student_data.weight_for_assignment_type(assignment_type)} #{term_for :weights}"
            .badge.badge-info= link_to "Change #{term_for :weights}", assignment_type_weights_path(:student_id => current_student.id), assignment_type: assignment_type, user_id: current_student
          - else
            .badge.badge-info= link_to "Set #{term_for :weights}", assignment_type_weights_path(:student_id => current_student.id), assignment_type: assignment_type
      - elsif assignment_type.student_weightable?
        .badge.badge-primary= "#{current_student_data.weight_for_assignment_type(assignment_type)} #{term_for :weights}"
      .clear
      %p
      .col-lg-12
        - assignments.each do |assignment|
          .col.col-lg-12.col-sm-12.col-xs-12.col-md-12.clear
            %span.assignmentName= link_to assignment.name, assignment_path(assignment, :student_id => current_student)
            - if assignment.release_necessary?
              - if current_student_data.grade_released_for_assignment?(assignment)
                %span.points.earned= "#{points current_student_data.score_for_assignment(assignment)} "
                %span.points= "/"
            - else
              - grade = current_student_data.grade_for_assignment(assignment)
              - if current_student_data.grade_released_for_assignment?(assignment)
                %span.points.earned= "#{points current_student_data.score_for_assignment(assignment)}  / "
            %span.points.total #{points current_student_data.point_total_for_assignment(assignment)} points
            - if assignment.assignment_type.student_weightable? && current_student_data.weighted_assignments? && current_course.assignment_weight_open?
              = "(Multiplied) "
              %b= "–"
              - if current_student_data.grade_released_for_assignment?(assignment)
                - grade = current_student_data.grade_for_assignment(assignment)
                %span.points.earned= points grade.raw_score
                %span.points= "/"
              %span.points= points assignment.point_total
              %span.points points (Raw)
            %span
            - if assignment.future?
              %span.italic= " • Due: #{assignment.due_at.strftime("%A, %B %d")}"
            - if assignment.is_required?
              %span.label.label-important Required!
            - if assignment.self_gradeable? && assignment.open? && assignment_type.name == 'Attendance' && current_user.is_student?
              = simple_form_for([assignment, current_student_data.grade_for_assignment(assignment)], :url => self_log_assignment_grades_path(:assignment_id => assignment.id), :method => :post) do |f|
                - present = current_student_data.present_for_class?(assignment)
                = hidden_field_tag :present, !present
                = f.submit (present ? assignment_type.student_logged_revert_button_text : assignment_type.student_logged_button_text), :class => "btn #{present ? 'btn-warning' : 'btn-success'} btn-tiny"
            - if assignment.has_groups?
              - if current_student.group_for_assignment(assignment)
                = link_to "See Group", group_path(current_student.group_for_assignment(assignment)), :class => "btn btn-primary btn-xs"
                //- if assignment.accepts_submissions?
                //= render "users/group_submissions", assignment: assignment, group: current_student.group_for_assignment(assignment)
              - else
                = link_to "Create a Group", new_group_path, :class => "btn btn-primary btn-xs"
            - else
              - if assignment.accepts_submissions?
                = render "users/submissions", assignment: assignment
            - if current_student_data.grade_released_for_assignment?(assignment) && current_student_data.grade_for_assignment(assignment).feedback?
              = link_to "See Feedback", assignment_grade_path(assignment, current_student_data.grade_for_assignment(assignment), :student_id => current_student), :class => "btn btn-info btn-xs"
      %hr
