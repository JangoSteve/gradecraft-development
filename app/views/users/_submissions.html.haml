- @user.submissions.where(assignment: assignment).first_or_initialize.tap do |submission|
  - if submission.persisted?
    %a{:href => "#submission_for_assignment-#{assignment.id}", :role => "button", :class => "btn btn-info btn-tiny", "data-toggle" => "modal"} See Submission
    .modal.fade{:id => "submission_for_assignment-#{assignment.id}"}
      .modal-dialog
        .modal-content
          .modal-header{"role" => "dialog", "tabindex" => "-1" }
            %button{:type => "button", :class => "close", "data-dismiss" => "modal", "aria-hidden" => "true"} x
            %h3= assignment.name
          .modal-body
            %h4= link_to submission.link, submission.link
            - if submission.link?
              %iframe.col-lg-12{:src => submission.link}
            - if submission.submission_files.present?
              - submission.submission_files.each do |submission_file|
                = link_to submission_file.filename, submission_file.filename_url.to_s
            %p= submission.comment
          .modal-footer
            %a{:href => "#", :class => "btn btn-info", "data-dismiss" => "modal", "aria-hidden" => "true"} Close
            %a{:href => "#", :class => "btn btn-primary"} Save changes
  - else
    %a{:href => "#submission_for_assignment-#{assignment.id}", :role => "button", :class => "btn btn-info btn-tiny", "data-toggle" => "modal"} Submit
    = render "users/submission_form", assignment: assignment, submission: submission