%h4.uppercase Supporting Files
.s3_uploader
  = s3_uploader_form key: upload_url('badge_files', @badge), acl: "private", max_file_size: 40.megabytes do
    .small-12.columns
      = file_field_tag :file, :multiple => true
    .small-12.columns
      .upload.s3_progress
        Progress:
        .progress
          .bar
      .clearfix
    - if @badge.badge_files.present?
      %hr
      %h5.bold Uploaded files
      %ul#uploaded_files
        - @badge.badge_files.each do |bf|
          %li
            = link_to bf.try(:filename), bf.try(:url), :target => "_blank"
            = link_to "[Remove]", remove_uploads_path({ :model => "BadgeFile", :badge_id => @badge.id, :upload_id => bf.id } )


    .small-12.large-8.columns.panel
      = f.simple_fields_for :badge_files, @badge.badge_files.new do |af|
        = af.file_field :file, :multiple => true
      - if @badge.badge_files.exists?
        %h5.bold Uploaded files
        %ul#uploaded_files
          - @badge.badge_files.each do |bf|
            - next if bf.new_record?
            %li
              - if bf.file_processing
                = "#{bf.filename} (upload in progress...)"
              - else
                = link_to bf.filename, bf.url, :target => "_blank"
                = link_to "(Remove)", remove_uploads_path({ :model => "BadgeFile", :badge_id => @badge.id, :upload_id => bf.id } )
