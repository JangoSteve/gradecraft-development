%div.col.col-lg-12#content_nav
  - if current_user.is_staff?
    = link_to 'Create a New Badge', new_badge_path, :class => "btn btn-info col col-sm-12 col-lg-2 btn-tiny pull-right"
    
%table.display.table-bordered.table#sortableTable.tablesorter
  %thead
    %tr
      %th#icon Icon
      %th#title Description
      %th#tasks Tasks
      - if current_course.valuable_badges?
        %th Value
      - if current_user.is_staff?
        %th#visible Visible to Students
        %th.header
        %th.header
  %tbody
    - @badges.each do |badge|
      - if current_user.is_staff?
        %tr
          %td
            %img{:src => badge.icon, :alt => badge.name}
            %td
              = link_to badge.name, badge_path(badge)
              = raw badge.description
            %td
              %ul
                - badge.tasks.each do |task|
                  %li= task.name
                %h5 Add a New Task
                = simple_fields_for(:tasks, :class => "form-horizontal") do |task|
                  = task.input :title
                  = task.input :description
                  = task.input :due_at, :id => "datetimepicker"
                  = task.input :accepts_submissions, :as => :boolean
                  = task.input :group, :as => :boolean
                  .form-actions
                    %div.btn-toolbar    
                      %div.btn-group
                        = task.button :submit, @button_title, :class => "btn-primary btn-tiny"
  
            - if current_course.valuable_badges?
              %td= number_with_delimiter(badge.point_total)
            %td 
              - if badge.visible == "1"
                Yes
              - else
                No
            %td= link_to 'Edit', edit_badge_path(badge), :class => 'btn btn-tiny btn-success'
            %td= link_to 'Delete', badge_path(badge), :class => 'btn btn-tiny btn-success', :data => { :confirm => 'Are you sure?' }, :method => :delete
      - else
        - if badge.visible == "1"
          %tr
            %td
              %img{:src => badge.icon, :alt => badge.name}
              %td
                = badge.name
                = raw badge.description
              - if current_course.valuable_badges?
                %td= badge.value
