= content_nav_for Assignment do
  %li= link_to "Create a New #{term_for :assignment}", new_assignment_path, :class => "btn btn-tiny btn-info"

.col-lg-12
  %h3= @title

- @assignments.group_by(&:assignment_type).each do |assignment_type, assignments|
  .col-lg-12
    %h3= link_to assignment_type.name, assignment_type
  %table.table.simpleTable.table-striped
    %thead
      %tr
        %th.sortable{"data-sort" => "string"} Name
        %th.sortable{"data-sort" => "date"} Open Date
        %th.sortable{"data-sort" => "date"} Due Date
        %th.sortable{"data-sort" => "date"} Accept Until
        %th.sortable{"data-sort" => "int"} Total Points
        %th.sortable{"data-sort" => "int"} Average
        %th.sortable{"data-sort" => "int"} Range
        %th(colspan="1")
        %th
    %tbody
      - assignments.each do |assignment|
        %tr
          %td= link_to assignment.name, assignment
          %td= assignment.try(:open_at)
          %td= assignment.try(:due_at)
          %td= assignment.try(:accepts_submissions_until)
          %td= number_with_delimiter(assignment.point_total, :delimiter => ',')
          %td= number_with_delimiter(assignment.average, :delimiter => ',')
          %td= "#{number_with_delimiter(assignment.low_score, :delimiter => ',')} - #{number_with_delimiter(assignment.high_score, :delimiter => ',')}"
          %td
            - if assignment_type.mass_grade?
              = link_to 'Log Grades',  mass_grade_assignment_path(assignment), :class => 'btn btn-tiny btn-success'
            - elsif assignment.accepts_submissions? && assignment.submissions.present?
              = link_to "Grade #{ assignment.submissions.count } Submissions", assignment_submissions_path(assignment), :class => "btn btn-tiny btn-success"
            - else
              = link_to "Grade", assignment_path(assignment), :class => "btn btn-tiny btn-success"
          %td= link_to "Edit", edit_assignment_path(assignment), :class => 'btn btn-tiny btn-info'

