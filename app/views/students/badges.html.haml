.small-12.panel.mainContent

  %h3.pagetitle= @title    

  .small-12.columns
    %dl.tabs{:data => {'tab' => true}}
      %dd.active
        - if current_user_is_student?
          %a{ "href" => "#tabb1"} My #{term_for :badges}
        - else
          %a{ "href" => "#tabb1"} #{current_student.name}'s #{term_for :badges}

      - if current_course.shared_badges?
        %dd
          %a{ "href" => "#tabb2"} Shared #{term_for :badges}

    //student badges table
    .tabs-content
      .content#tabb1.active.small-12
        %table.responsive.columns
          %thead
            %tr
              %th.center
                .sr-only Icon
              %th Earned
              %th{ :width => 300} Description
              - if current_course.shared_badges?
                %th Share this with the class?
          %tbody
            - current_course_data.badges.each do |badge|
              %tr
                %td.center
                  %img{ :src => badge.icon, :alt => badge.name, :width => "100" }
                  .bold= badge.name
                  = "#{points badge.point_total} points" if badge.point_total?
                %td
                  - if badge.can_earn_multiple_times
                    - badge.earned_badges_for_student(current_student.id).each do
                      %img{ :src => badge.icon, :alt => badge.name, :width => "30" }
                      = current_student_data.earned_badge(badge).created_at
                      %p= raw current_student_data.earned_badge(badge).try(:feedback)

                    - if badge.earned_badges_for_student(current_student.id).count >1
                      = "#{points badge.earned_badge_total_value(current_student)} points earned" if badge.point_total?
                  - elsif current_student_data.earned_badge?(badge)
                    .fi-check
                    = current_student_data.earned_badge(badge).created_at
                    %p= raw current_student_data.earned_badge(badge).try(:feedback) 
                %td= raw badge.description
                - if current_course.shared_badges?
                  %td
                    - earned_badge = current_student_data.earned_badge(badge)
                    - if current_user_is_student? && earned_badge.present?
                      %div{:class=>"share_badge", :data => { badge_id: badge.id.to_s, earned_badge_id: earned_badge.id.to_s, name: badge.name, icon: badge.icon }}
                        - if earned_badge.shared?
                          %a.btn{:id => 'shared_' + badge.id.to_s, :class=>"remove_badge button radius"} Stop Sharing
                        - else
                          %a.btn{:id => 'shared_' + badge.id.to_s, :class=>"add_badge button radius"} Share
                    - elsif earned_badge.present?
                      - if earned_badge.shared?
                        = "Shared"
                        %a.btn{:id => 'shared_' + badge.id.to_s, :class=>"remove_badge button radius"} Stop Sharing
                      - else
                        = "Not Shared"
                        %a.btn{:id => 'shared_' + badge.id.to_s, :class=>"add_badge button radius"} Share

      .content#tabb2.small-12
        = render "students/public_class_badges"