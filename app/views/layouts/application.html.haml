!!! 5
%html(lang="en")
  %head
    %meta(charset="utf-8")
    %meta(name="viewport" content="width=device-width, initial-scale=1.0")
    %title= content_for?(:title) ? yield(:title) : (current_course.try(:name) || 'GradeCraft')
    = csrf_meta_tags
    / Le HTML5 shim, for IE6-8 support of HTML elements
    /[if lt IE 9]
      = javascript_include_tag "https://html5shim.googlecode.com/svn/trunk/html5.js"
    = stylesheet_link_tag "application", :media => "all"
    = javascript_include_tag 'application'
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    - if current_course.try(:theme).present?
      %link{ :href => current_course.theme.try(:filename), :media => "all", :rel => "stylesheet"}
  %body
    .navbar.navbar-fixed-top
      .navbar-inner
        .container-fluid
          %a.brand(href="/dashboard")
            - if current_course
              #{current_course.name}
            - else
              GradeCraft
          %div.pull-right
            - if current_user && current_course
              %div{:class => 'btn-group pull-right inline-fix'}
                - if current_user.is_admin? 
                  = link_to "Course Dashboard",  dashboard_path, :class => "btn"
                - else
                  = link_to "My Dashboard",  dashboard_path, :class => "btn"    
                - if current_user.is_staff?
                  = link_to "Assignments", assignments_path, :class => "btn"
                  - if current_course.has_teams?
                    = link_to "#{current_course.team_ref}s", teams_path, :class => "btn"
                - if current_course.has_badges?                
                  = link_to "Badges", badges_path, :class => "btn"
                - if current_user.is_student? && current_course.has_teams? && current_course.teams_visible?                
                  = link_to "#{current_course.team_ref}s", teams_path, :class => "btn"
                //- if current_user.is_student?  
                //= link_to "Predictor",  predictor_users_path(:user_id => current_user.id), :class => "btn"
            - if current_user.try(:is_staff?) && current_course
              %div{:class => 'btn-group pull-right'}
                %a{:class => 'btn btn-success dropdown-toggle', "data-toggle" => 'dropdown', :href => '#' }
                  Course
                  %i.caret
                %ul{:class => 'dropdown-menu well'}
                  %li= link_to "Gradebook", gradebook_path
                  %li= link_to "New Assignment", new_assignment_path
                  %li= link_to "Assignment Types", assignment_types_path
                  %li= link_to "#{current_course.user_ref}s", students_users_path
                  - if current_course.has_groups?    
                    %li= link_to "Groups", groups_path
                  - if current_course.has_teams?    
                    %li= link_to "#{current_course.team_ref}s", teams_path
                  %li= link_to "Staff", staff_users_path
                  %li= link_to "Course Settings", edit_course_path(current_course)
            - if current_user
              %div{:class => 'btn-group pull-right'}
                %a{:class => 'btn dropdown-toggle', "data-toggle" => 'dropdown', :href => '#' }
                  = current_user.public_name
                  %i.caret
                %ul{:class => 'dropdown-menu well'}
                  %li= link_to "My Account", edit_profile_users_path
                  %li= link_to "Logout", :logout
            - else
              %div{:class => 'btn-group pull-right'}
                %a{:class => 'btn btn-primary dropdown-toggle', "data-toggle" => 'dropdown', :href => '#' }
                  Login
                  %span{:class => 'caret'}
                %ul{:class => 'dropdown dropdown-menu well'}
                  = simple_form_for User.new, :url => user_sessions_path do |f|
                    = f.input :email, :label => false
                    = f.input :password, :label => false
                    %span.control-label= "Remember Me"
                    = f.input :remember_me, :as => :boolean, :label => false
                    = submit_tag "Login", :class => 'btn btn-primary'
                    %br
                    %br
                    = link_to "Forgot your password?", login_path, :class => 'btn btn-info'

    .container-fluid.container
      .row-fluid
        = render 'layouts/content'
  
      %footer#siteFooter
        &copy; 2012 Regents of the University of Michigan &#124;
        = link_to "Using Gradecraft", using_gradecraft_path
        | 
        = link_to "Site Credits", credits_path
        
    .navbar.navbar-fixed-bottom
      .navbar-inner
        - if current_user.try(:is_admin?)
          %div{:class => 'btn-group pull-left'}
            = form_tag change_current_course_path do
              = select_tag 'course_id', options_from_collection_for_select(current_user.courses, 'id', 'name', current_course.id)
        <!-- begin olark code --><script data-cfasync="false" type='text/javascript'>/*{literal}<![CDATA[*/
window.olark||(function(c){var f=window,d=document,l=f.location.protocol=="https:"?"https:":"http:",z=c.name,r="load";var nt=function(){f[z]=function(){(a.s=a.s||[]).push(arguments)};var a=f[z]._={},q=c.methods.length;while(q--){(function(n){f[z][n]=function(){f[z]("call",n,arguments)}})(c.methods[q])}a.l=c.loader;a.i=nt;a.p={0:+new Date};a.P=function(u){a.p[u]=new Date-a.p[0]};function s(){a.P(r);f[z](r)}f.addEventListener?f.addEventListener(r,s,false):f.attachEvent("on"+r,s);var ld=function(){function p(hd){hd="head";return["<",hd,"></",hd,"><",i,' onl' + 'oad="var d=',g,";d.getElementsByTagName('head')[0].",j,"(d.",h,"('script')).",k,"='",l,"//",a.l,"'",'"',"></",i,">"].join("")}var i="body",m=d[i];if(!m){return setTimeout(ld,100)}a.P(1);var j="appendChild",h="createElement",k="src",n=d[h]("div"),v=n[j](d[h](z)),b=d[h]("iframe"),g="document",e="domain",o;n.style.display="none";m.insertBefore(n,m.firstChild).id=z;b.frameBorder="0";b.id=z+"-loader";if(/MSIE[ ]+6/.test(navigator.userAgent)){b.src="javascript:false"}b.allowTransparency="true";v[j](b);try{b.contentWindow[g].open()}catch(w){c[e]=d[e];o="javascript:var d="+g+".open();d.domain='"+d.domain+"';";b[k]=o+"void(0);"}try{var t=b.contentWindow[g];t.write(p());t.close()}catch(x){b[k]=o+'d.write("'+p().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};ld()};nt()})({loader: "static.olark.com/jsclient/loader0.js",name:"olark",methods:["configure","extend","declare","identify"]});
/* custom configuration goes here (www.olark.com/documentation) */
olark.identify('9377-933-10-5960');/*]]>{/literal}*/</script><noscript><a href="https://www.olark.com/site/9377-933-10-5960/contact" title="Contact us" target="_blank">Questions? Feedback?</a> powered by <a href="http://www.olark.com?welcome" title="Olark live chat software">Olark live chat software</a></noscript><!-- end olark code -->