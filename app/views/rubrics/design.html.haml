= csrf_meta_tag
.small-12.panel.mainContent
  .small-12.columns
    #rubric(ng-app="gradecraft" ng-controller="RubricCtrl" ng-init="init(#{@rubric[:id]}, #{@assignment.point_total}, #{@metrics})")
      %br
      %br
      #rubric-title
        %h3 Design Rubric for "#{@assignment.name}"
        %h5.subtitle Rubric is saved dynamically and does not need to be "submitted"
      #points-overview
        %h4#points-assigned {{pointsAssigned()}}/#{@assignment.point_total} Points Assigned
        %h4#points-remaining {{pointsRemaining(#{@assignment.point_total})}} Points Remaining
      .clear
      %br

      .splash(ng-cloak) Loading rubric...
      %br
      %br

      .row.assignment-return
        = link_to '&laquo; Return to Assignment'.html_safe, assignment_path(@assignment), class: "return-link"
      .row
        .metric.small-3.columns.heading
          Criteria
          %button#add-metric(type="button" ng-click="newMetric()") + New Criterion
        .tier.small-8.columns.heading Levels

      #metric-box(ng-cloak)

        .row.divider(ng-repeat="metric in metrics")
          .order-label {{$index + 1}}
          .metric.small-3.columns(name="metricForm" ng-form ng-submit="metric.create()" ng-class="{saved: metric.isSaved()}" ng-animate="{enter: 'animate-enter', leave: 'animate-leave'}")
            = render "rubrics/new_metric"
          .tier.small-3.columns(name="tierForm" ng-repeat="tier in metric.tiers" ng-form ng-submit="tier.create()" ng-class="{saved: tier.isSaved()}")
            = render "rubrics/new_tier"
          %button.add-tier(name="newTier" ng-click="metric.addTier()" ng-show="metric.isSaved()")
            + Tier
          .clear

      .row
        %button#new-rubric-metric(type="button" ng-click="newMetric()") + Criterion

  .clearfix
