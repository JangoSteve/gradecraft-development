/*
 * jQuery Dynatable plugin 0.0.1
 *
 * Copyright (c) 2011 Steve Schwartz (JangoSteve)
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Date: Thu Jul 15 11:40:00 2011 -0500
 */
//
(function(e){var t={};e.dynatableSetup=function(n){e.extend(!0,t,n)},e.dynatable=function(n,r){var i={features:{paginate:!0,sort:!0,pushState:!0,search:!0,recordCount:!0,perPageSelect:!0},table:{defaultColumnIdStyle:"camelCase",columns:null,headRowSelector:"thead tr",bodyRowSelector:"tbody tr",headRowClass:null,rowFilter:function(t,n,r,i){var s=e("<tr></tr>");return e.each(r,function(e,t){var r=t.dataFilter(n),o=i(r);t.hidden&&o.hide(),t.textAlign&&o.css("text-align",t.textAlign),s.append(o)}),s},cellFilter:function(t){return e("<td></td>",{html:t})}},inputs:{queries:null,sorts:null,multisort:["ctrlKey","shiftKey","metaKey"],page:null,queryEvent:"blur change",recordCountTarget:null,recordCountPlacement:"after",paginationLinkTarget:null,paginationLinkPlacement:"after",paginationPrev:"Previous",paginationNext:"Next",paginationGap:[1,2,2,1],searchTarget:null,searchPlacement:"before",perPageTarget:null,perPagePlacement:"before",perPageText:"Show: ",recordCountText:"Showing ",processingText:"Processing..."},dataset:{ajax:!1,ajaxUrl:null,ajaxCache:null,ajaxOnLoad:!1,ajaxMethod:"GET",ajaxDataType:"json",totalRecordCount:null,queries:null,queryRecordCount:null,page:null,perPage:10,perPageOptions:[10,20,50,100],sorts:null,sortsKeys:null,sortTypes:{},records:null},filters:{},unfilters:{},params:{dynatable:"dynatable",queries:"queries",sorts:"sorts",page:"page",perPage:"perPage",offset:"offset",records:"records",record:null,queryRecordCount:"queryRecordCount",totalRecordCount:"totalRecordCount"}},s=this,o=e(n),u;s.settings={},s.init=function(){r&&(r.inputs&&(r.inputs.multisort&&(i.inputs.multisort=undefined,t.inputs&&t.inputs.multisort&&(t.inputs.multisort=undefined)),r.inputs.paginationGap&&(i.inputs.paginationGap=undefined,t.inputs&&t.inputs.paginationGap&&(t.inputs.paginationGap=undefined))),r.dataset&&r.dataset.perPageOptions&&(i.dataset.perPageOptions=undefined,t.dataset&&t.dataset.perPageOptions&&(t.dataset.perPageOptions=undefined))),s.settings=u=e.extend(!0,{},i,t,r),s.processingIndicator.attach(),u.table.columns=[],o.is("table")&&s.columns.getFromTable(),u.dataset.records===null&&!u.dataset.ajax&&(u.dataset.records=s.records.getFromTable()),u.dataset.queryRecordCount||(u.dataset.queryRecordCount=s.records.count()),u.dataset.totalRecordCount||(u.dataset.totalRecordCount=u.dataset.queryRecordCount);var n=window.location.search.match(new RegExp(u.params.sorts+"[^&=]*=[^&]*","g")),a=window.location.search.match(new RegExp(u.params.queries+"[^&=]*=[^&]*","g")),f=window.location.search.match(new RegExp(u.params.page+"=([^&]*)")),l=window.location.search.match(new RegExp(u.params.perPage+"=([^&]*)"));u.dataset.queries=a?s.utility.deserialize(a)[u.params.queries]:{},u.dataset.queries===""&&(u.dataset.queries={}),u.features.recordCount&&s.recordCount.attach(),u.features.search&&s.search.attach(),u.dataset.ajax||(u.dataset.originalRecords=e.extend(!0,[],u.dataset.records)),u.features.paginate&&(l&&s.perPage.set(l[1]),s.page.set(f?f[1]:1),s.paginationLinks.attach(),u.features.perPageSelect&&s.perPage.attach()),u.features.sort&&(u.dataset.sorts=n?s.utility.deserialize(n)[u.params.sorts]:{},u.dataset.sortsKeys=n?s.utility.keysFromObject(u.dataset.sorts):[],s.sortHeaders.attach()),u.inputs.queries&&s.queries.setupInputs(),(!u.dataset.ajax||u.dataset.ajax&&u.dataset.ajaxOnLoad||u.features.paginate)&&s.process(),u.features.pushState&&history.pushState&&(window.onpopstate=function(e){e.state&&e.state.dynatable&&s.state.pop(e)})},s.process=function(t){var n={};o.trigger("dynatable:beforeProcess",n),e.isEmptyObject(u.dataset.queries)||(n[u.params.queries]=u.dataset.queries),s.processingIndicator.show(),u.features.sort&&!e.isEmptyObject(u.dataset.sorts)&&(n[u.params.sorts]=u.dataset.sorts);if(u.features.paginate&&u.dataset.page){var r=u.dataset.page,i=u.dataset.perPage;n[u.params.page]=r,n[u.params.perPage]=i,n[u.params.offset]=(r-1)*i}u.dataset.ajaxData&&e.extend(n,u.dataset.ajaxData);if(u.dataset.ajax){var a={type:u.dataset.ajaxMethod,dataType:u.dataset.ajaxDataType,data:n,success:function(e){o.trigger("dynatable:ajax:success",e),s.records.updateFromJson(e),s.table.update(),u.features.pushState&&!t&&history.pushState&&s.state.push(n)},complete:function(){s.processingIndicator.hide()}};u.dataset.ajaxUrl?a.url=u.dataset.ajaxUrl:a.url=s.utility.refreshQueryString(window.location.href,{}),u.dataset.ajaxCache!==null&&(a.cache=u.dataset.ajaxCache),e.ajax(a)}else s.records.resetOriginal(),s.queries.run(),u.features.sort&&s.records.sort(),u.features.paginate&&s.records.paginate(),s.table.update(),s.processingIndicator.hide(),u.features.pushState&&!t&&history.pushState&&s.state.push(n);o.trigger("dynatable:afterProcess",n)},s.state={push:function(t){var n=window.location.search,r,i,a,f;n&&/^\?/.test(n)&&(n=n.substring(1)),e.extend(r,t),params=s.utility.refreshQueryString(n,t),o.trigger("dynatable:push",t),f={dynatable:{dataset:u.dataset}},a=JSON.stringify(f),f.dynatable.dataset.perPageOptions=e.makeArray(f.dynatable.dataset.perPageOptions);try{window.history.pushState(f,"Dynatable state","?"+params)}catch(l){f.dynatable.dataset.records=null,window.history.pushState(f,"Dynatable state","?"+params)}},pop:function(e){var t=e.state.dynatable;u.dataset=t.dataset,t.dataset.records?s.table.update():s.process(!0)}},s.table={update:function(){var t=e(),r=u.table.columns,i=u.table.rowFilter,a=u.table.cellFilter;o.trigger("dynatable:beforeUpdate",t),e.each(u.dataset.records,function(e,n){var s=i(e,n,r,a);t=t.add(s)}),u.features.recordCount&&e("#dynatable-record-count-"+n.id).replaceWith(s.recordCount.create()),u.features.paginate&&(e("#dynatable-pagination-links-"+n.id).replaceWith(s.paginationLinks.create()),u.features.perPageSelect&&e("#dynatable-per-page-"+n.id).val(parseInt(u.dataset.perPage))),u.features.sort&&(s.sortHeaders.removeAllArrows(),e.each(r,function(){var t=this,n=s.utility.allMatch(u.dataset.sorts,t.sorts,function(e,t){return t in e}),r=u.dataset.sorts[t.sorts[0]];n&&o.find('[data-dynatable-column="'+t.id+'"]').find(".dynatable-sort-header").each(function(){r==1?s.sortHeaders.appendArrowUp(e(this)):s.sortHeaders.appendArrowDown(e(this))})})),u.inputs.queries&&u.inputs.queries.each(function(){var t=e(this),n=u.dataset.queries[t.data("dynatable-query")];e(this).val(n||"")}),o.find(u.table.bodyRowSelector).remove(),o.append(t),o.trigger("dynatable:afterUpdate",t)}},s.sortHeaders={create:function(t){var n=e(t),r=e("<a></a>",{"class":"dynatable-sort-header",href:"#",html:n.html()}),i=n.data("dynatable-column"),o=s.utility.findObjectInArray(u.table.columns,{id:i});return r.bind("click",function(e){s.sortHeaders.toggleSort(e,r,o),s.process(),e.preventDefault()}),s.sortHeaders.sortedByColumn(r,o)&&(s.sortHeaders.sortedByColumnValue(o)==1?s.sortHeaders.appendArrowUp(r):s.sortHeaders.appendArrowDown(r)),r},attach:function(){o.find(u.table.headRowSelector).children("th,td").each(function(){s.sortHeaders.attachOne(this)})},attachOne:function(t){var n=e(t);n.data("dynatable-no-sort")||n.html(s.sortHeaders.create(t))},appendArrowUp:function(e){s.sortHeaders.removeArrow(e),e.append("<span class='dynatable-arrow'> &#9650;</span>")},appendArrowDown:function(e){s.sortHeaders.removeArrow(e),e.append("<span class='dynatable-arrow'> &#9660;</span>")},removeArrow:function(e){e.find(".dynatable-arrow").remove()},removeAllArrows:function(){o.find(".dynatable-arrow").remove()},toggleSort:function(t,n,r){var i=s.sortHeaders.sortedByColumn(n,r),o=s.sortHeaders.sortedByColumnValue(r);if(!u.inputs.multisort||!s.utility.anyMatch(t,u.inputs.multisort,function(e,n){return t[n]}))s.sortHeaders.removeAllArrows(),s.sorts.clear();i?o==1?(e.each(r.sorts,function(e,t){s.sorts.add(t,-1)}),s.sortHeaders.appendArrowDown(n)):(e.each(r.sorts,function(e,t){s.sorts.remove(t)}),s.sortHeaders.removeArrow(n)):(e.each(r.sorts,function(e,t){s.sorts.add(t,1)}),s.sortHeaders.appendArrowUp(n))},sortedByColumn:function(e,t){return s.utility.allMatch(u.dataset.sorts,t.sorts,function(e,t){return t in e})},sortedByColumnValue:function(e){return u.dataset.sorts[e.sorts[0]]}},s.sorts={add:function(t,n){var r=u.dataset.sortsKeys,i=e.inArray(t,r);return u.dataset.sorts[t]=n,i===-1&&r.push(t),s},remove:function(t){var n=u.dataset.sortsKeys,r=e.inArray(t,n);return delete u.dataset.sorts[t],r!==-1&&n.splice(r,1),s},clear:function(){u.dataset.sorts={},u.dataset.sortsKeys.length=0},guessType:function(e,t,n){var r={string:"string",number:"number","boolean":"number",object:"number"},i=e[n]?typeof e[n]:typeof t[n],s=r[i]||"number";return s},functions:{number:function(e,t,n,r){return e[n]===t[n]?0:r>0?e[n]-t[n]:t[n]-e[n]},string:function(e,t,n,r){var i=e["dynatable-sortable-text"]&&e["dynatable-sortable-text"][n]?e["dynatable-sortable-text"][n]:e[n],s=t["dynatable-sortable-text"]&&t["dynatable-sortable-text"][n]?t["dynatable-sortable-text"][n]:t[n],o;return i=i.toLowerCase(),s=s.toLowerCase(),o=i===s?0:r>0?i>s:s>i,o===!1?-1:o-0},originalPlacement:function(e,t){return e["dynatable-original-index"]-t["dynatable-original-index"]}}},s.page={set:function(e){u.dataset.page=parseInt(e,10)}},s.queries={add:function(e,t){return u.features.paginate&&(u.dataset.page=1),u.dataset.queries[e]=t,s},remove:function(e){return delete u.dataset.queries[e],s},run:function(){e.each(u.dataset.queries,function(t,n){if(s.queries.functions[t]===undefined){var r=s.utility.findObjectInArray(u.table.columns,{id:t});if(!r)return e.error("Query named '"+t+"' called, but not defined in queries.functions"),!0;s.queries.functions[t]=function(e,n){return e[t]==n}}u.dataset.records=e.map(u.dataset.records,function(e){return s.queries.functions[t](e,n)?e:null})}),u.dataset.queryRecordCount=u.dataset.records.length},runSearch:function(t){var n=e.extend({},u.dataset.queries);t?s.queries.add("search",t):s.queries.remove("search"),s.utility.objectsEqual(u.dataset.queries,n)||s.process()},setupInputs:function(){u.inputs.queries.each(function(){var t=e(this),n=t.data("dynatable-query-event")||u.inputs.queryEvent,r=t.data("dynatable-query")||t.attr("name")||this.id,i=function(t){var n=e(this).val();n===""&&(n=undefined);if(n===u.dataset.queries[r])return!1;n?s.queries.add(r,n):s.queries.remove(r),s.process(),t.preventDefault()};t.attr("data-dynatable-query",r).bind(n,i).bind("keypress",function(e){e.which==13&&i.call(this,e)}),u.dataset.queries[r]&&t.val(decodeURIComponent(u.dataset.queries[r]))})},functions:{search:function(t,n){var r=!1;return e.each(t,function(e,t){return typeof t=="string"&&t.toLowerCase().indexOf(n.toLowerCase())!==-1?(r=!0,!1):!0}),r}}},s.paginationLinks={create:function(){var t=e("<ul></ul>",{id:"dynatable-pagination-links-"+n.id,"class":"dynatable-pagination-links",html:"<span>Pages: </span>"}),r="dynatable-page-link",i="dynatable-active-page",o=Math.ceil(u.dataset.queryRecordCount/u.dataset.perPage),a=u.dataset.page,f=[u.inputs.paginationGap[0],u.dataset.page-u.inputs.paginationGap[1],u.dataset.page+u.inputs.paginationGap[2],o+1-u.inputs.paginationGap[3]],l;for(var c=1;c<=o;c++){if(c>f[0]&&c<f[1]||c>f[2]&&c<f[3])continue;l=e("<a></a>",{html:c,"class":r,"data-dynatable-page":c}),a==c&&l.addClass(i);var h=e.inArray(c,f),p=f[h+1];if(h>0&&c!==1&&p&&p>c+1){var d=e('<span class="dynatable-page-break">&hellip;</span>');l=h<2?l.before(d):l.after(d)}if(u.inputs.paginationPrev&&c===1){var v=e("<a></a>",{html:u.inputs.paginationPrev,"class":r+" dynatable-page-prev","data-dynatable-page":a-1});a===1&&v.addClass(i),l=l.before(v)}if(u.inputs.paginationNext&&c===o){var m=e("<a></a>",{html:u.inputs.paginationNext,"class":r+" dynatable-page-next","data-dynatable-page":a+1});a===o&&m.addClass(i),l=l.after(m)}l.each(function(){t.append(e("<li />",{html:this}))})}var g="."+r+":not(."+i+")";return e(g).die("click.dynatable"),e(g).live("click.dynatable",function(t){$this=e(this),e("#dynatable-pagination-links").find("."+i).removeClass(i),$this.addClass(i),s.page.set($this.data("dynatable-page")),s.process(),t.preventDefault()}),t},attach:function(){var t=u.inputs.paginationLinkTarget?e(u.inputs.paginationLinkTarget):o;t[u.inputs.paginationLinkPlacement](s.paginationLinks.create())}},s.search={create:function(){var t=e("<input />",{type:"search",id:"dynatable-query-search-"+n.id,value:u.dataset.queries.search}),r=e("<span></span>",{id:"dynatable-search-"+n.id,"class":"dynatable-search",text:"Search: "}).append(t);return t.bind(u.inputs.queryEvent,function(){s.queries.runSearch(e(this).val())}).bind("keypress",function(t){t.which==13&&(s.queries.runSearch(e(this).val()),t.preventDefault())}),r},attach:function(){var t=u.inputs.searchTarget?e(u.inputs.searchTarget):o;t[u.inputs.searchPlacement](s.search.create())}},s.perPage={create:function(){var t=e("<select>",{id:"dynatable-per-page-"+n.id,"class":"dynatable-per-page-select"});return e.each(u.dataset.perPageOptions,function(e,n){var r=u.dataset.perPage==n?'selected="selected"':"";t.append('<option value="'+n+'" '+r+">"+n+"</option>")}),t.bind("change",function(t){s.perPage.set(e(this).val()),s.process()}),e("<span />",{html:t.before("<span class='dynatable-per-page-label'>"+u.inputs.perPageText+"</span>"),"class":"dynatable-per-page"})},attach:function(){var t=u.inputs.perPageTarget?e(u.inputs.perPageTarget):o;t[u.inputs.perPagePlacement](s.perPage.create())},set:function(e){s.page.set(1),u.dataset.perPage=parseInt(e)}},s.recordCount={create:function(){var t=u.dataset.records.length,r=u.dataset.queryRecordCount,i=u.dataset.totalRecordCount,o=u.inputs.recordCountText,a=u.params.records;if(t<r&&u.features.paginate){var f=s.records.pageBounds();o+="<span class='dynatable-record-bounds'>"+(f[0]+1)+" to "+f[1]+"</span> of "}else t===r&&u.features.paginate&&(o+=t+" of ");return o+=r+" "+a,r<i&&(o+=" (filtered from "+i+" total records)"),e("<span></span>",{id:"dynatable-record-count-"+n.id,"class":"dynatable-record-count",html:o})},attach:function(){var t=u.inputs.recordCountTarget?e(u.inputs.recordCountTarget):o;t[u.inputs.recordCountPlacement](s.recordCount.create())}},s.processingIndicator={create:function(){var t=e("<div></div>",{html:"<span>"+u.inputs.processingText+"</span>",id:"dynatable-processing-"+n.id,"class":"dynatable-processing",style:"position: absolute; display: none;"});return t},position:function(){var t=e("#dynatable-processing-"+n.id),r=t.children("span"),i=r.outerHeight(),s=r.outerWidth(),u=o,a=u.offset(),f=u.outerHeight(),l=u.outerWidth();return t.offset({left:a.left,top:a.top}).width(l).height(f),r.offset({left:a.left+(l-s)/2,top:a.top+(f-i)/2}),t},attach:function(){o.before(s.processingIndicator.create())},show:function(){e("#dynatable-processing-"+n.id).show(),s.processingIndicator.position()},hide:function(){e("#dynatable-processing-"+n.id).hide()}},s.records={updateFromJson:function(e){var t;u.params.records==="_root"?t=e:u.params.records in e&&(t=e[u.params.records]);if(u.params.record){var n=t.length-1;for(var r=0;r<n;r++)t[r]=t[r][u.params.record]}u.params.queryRecordCount in e&&(u.dataset.queryRecordCount=e[u.params.queryRecordCount]),u.params.totalRecordCount in e&&(u.dataset.totalRecordCount=e[u.params.totalRecordCount]),u.dataset.records=t},sort:function(){var t=[].sort,n=u.dataset.sorts,r=u.dataset.sortsKeys,i=u.dataset.sortTypes,o=function(t,o){var u;return e.isEmptyObject(n)?u=s.sorts.functions.originalPlacement(t,o):e.each(r,function(e,r){var f=n[r],l=i[r]||s.sorts.guessType(t,o,r);return u=s.sorts.functions[l](t,o,r,f),u==0}),u};return t.call(u.dataset.records,o)},paginate:function(){var e=s.records.pageBounds(),t=e[0],n=e[1];u.dataset.records=u.dataset.records.slice(t,n)},resetOriginal:function(){u.dataset.records=e.extend(!0,[],u.dataset.originalRecords)},pageBounds:function(){var e=u.dataset.page||1,t=(e-1)*u.dataset.perPage,n=Math.min(t+u.dataset.perPage,u.dataset.queryRecordCount);return[t,n]},getFromTable:function(){var t=[],n=u.table.columns,r=o.find(u.table.bodyRowSelector);return r.each(function(r){var i={};i["dynatable-original-index"]=r,e(this).find("th,td").each(function(t){n[t]===undefined&&s.columns.add(s.columns.generate(),n.length,!1,!0);var r=n[t].dataUnfilter(this,i),o=n[t].id;typeof r=="string"&&r.match(/\s*\<.+\>/)&&(i["dynatable-sortable-text"]||(i["dynatable-sortable-text"]={}),i["dynatable-sortable-text"][o]=e(e.trim(r)).text()),i[o]=r}),typeof u.table.rowUnfilter=="function"&&u.table.rowUnfilter(r,this,i),t.push(i)}),t},count:function(){return u.dataset.records.length}},s.columns={getFromTable:function(){var t=o.find(u.table.headRowSelector).children("th,td");if(!t.length)return e.error("Couldn't find any columns headers in '"+u.table.headRowSelector+" th,td'. If your header row is different, specify the selector in the table: headRowSelector option.");t.each(function(t){s.columns.add(e(this),t,!0)})},add:function(t,n,r,i){var a=u.table.columns,f=t.text(),l=t.data("dynatable-column")||s.utility.normalizeText(f),c=t.data("dynatable-sorts"),h=c?e.map(c.split(","),function(t){return e.trim(t)}):[l];l||(s.columns.generate(t),l=t.data("dynatable-column")),a.splice(n,0,{index:n,label:f,id:l,dataFilter:u.filters[l]||s.columns.defaultFilter,dataUnfilter:u.unfilters[l]||s.columns.defaultUnfilter,sorts:h,hidden:t.css("display")==="none",textAlign:t.css("text-align")}),t.attr("data-dynatable-column",l).addClass("dynatable-head"),u.table.headRowClass&&t.addClass(u.table.headRowClass);if(!r){var p=n+1,d=o.find(u.table.headRowSelector).children("th:nth-child("+p+"),td:nth-child("+p+")").first(),v=a.slice(n+1,a.length);d.length?d.before(t):o.find(u.table.headRowSelector).append(t),s.sortHeaders.attachOne(t.get()),v.length&&e.each(v,function(){this.index+=1}),i||s.table.update()}return s},remove:function(e){var t=u.table.columns,n=t.length;if(typeof e=="number"){var r=t[e];s.columns.removeFromTable(r.id),s.columns.removeFromArray(e)}else for(var i=t.length-1;i>=0;i--){var r=t[i];r.id===e&&(s.columns.removeFromTable(e),s.columns.removeFromArray(i))}s.table.update()},removeFromTable:function(e){o.find(u.table.headRowSelector).children('[data-dynatable-column="'+e+'"]').first().remove()},removeFromArray:function(t){var n=u.table.columns;n.splice(t,1),e.each(n.slice(t,n.length),function(){this.index-=1})},defaultFilter:function(e){return e[this.id]},defaultUnfilter:function(t,n){return e(t).html()},generate:function(t){var n=t===undefined?e("<th></th>"):t;return s.columns.attachGeneratedAttributes(n)},attachGeneratedAttributes:function(e){var t=o.find(u.table.headRowSelector).children("th[data-dynatable-generated]").length;return e.attr("data-dynatable-column","dynatable-generated-"+t).attr("data-dynatable-no-sort","true").attr("data-dynatable-generated",t)}},s.utility={normalizeText:function(e){var t=u.table.defaultColumnIdStyle;return e=s.utility.textTransform[t](e),e},textTransform:{trimDash:function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\s+/g,"-")},camelCase:function(e){return e=s.utility.textTransform.trimDash(e),e.replace(/(\-[a-zA-Z])/g,function(e){return e.toUpperCase().replace("-","")}).replace(/([A-Z])([A-Z]+)/g,function(e,t,n){return t+n.toLowerCase()}).replace(/^[A-Z]/,function(e){return e.toLowerCase()})},dashed:function(e){return e=s.utility.textTransform.trimDash(e),s.utility.textTransform.lowercase(e)},underscore:function(e){return e=s.utility.textTransform.trimDash(e),s.utility.textTransform.lowercase(e.replace(/(-)/g,"_"))},lowercase:function(e){return e.replace(/([A-Z])/g,function(e){return e.toLowerCase()})}},deserialize:function(t){if(!t)return{};typeof t=="object"&&(t=t.join("&"));var n={},r=t.split("&");for(var i=0;i<r.length;i++){var s=r[i].split("="),o=decodeURIComponent(s[0]),u,a;if(!s[1])continue;u=decodeURIComponent(s[1].replace(/\+/g," "));while(a=o.match(/([^&=]+)\[([^&=]+)\]$/)){var f=u;o=a[1],u={},a[2].substr(a[2].length-2)=="]["?u[a[2].substr(0,a[2].length-2)]=[f]:u[a[2]]=f}typeof n[o]=="undefined"?o.substr(o.length-2)!="[]"?n[o]=u:n[o]=[u]:typeof n[o]=="string"?n[o]=u:typeof n[o]=="object"?n[o]=e.extend({},n[o],u):n[o].push(u)}return n},refreshQueryString:function(t,n){var r=t.split("?"),i=r.shift(),o;return o=s.utility.deserialize(t),e.each(u.params,function(t,r){if(!u.features.sort&&t=="sorts"||!u.features.paginate&&s.utility.anyMatch(t,["page","perPage","offset"],function(e,t){return e==t}))return!0;if(t=="queries"&&n[r]){var i=e.makeArray(u.inputs.queries.map(function(){return e(this).attr("name")}));return e.each(i,function(e,t){n[r][t]?(typeof o[r]=="undefined"&&(o[r]={}),o[r][t]=n[r][t]):delete o[r][t]}),!0}n[r]?o[r]=n[r]:delete o[r]}),decodeURI(e.param(o))},keysFromObject:function(e){var t=[];for(var n in e)t.push(n);return t},findObjectInArray:function(t,n){var r;return e.each(t,function(e,t){if(s.utility.allMatch(t,n,function(e,t,n){return e[t]==n}))return r=t,!1}),r},allMatch:function(t,n,r){var i=!0,s=e.isArray(n);return e.each(n,function(e,n){var o=s?r(t,n):r(t,e,n);if(!o)return i=!1}),i},anyMatch:function(t,n,r){var i=!1,s=e.isArray(n);return e.each(n,function(e,n){var o=s?r(t,n):r(t,e,n);if(o)return i=!0,!1}),i},objectsEqual:function(e,t){for(attr in e)if(e.hasOwnProperty(attr))if(!t.hasOwnProperty(attr)||e[attr]!==t[attr])return!1;for(attr in t)if(t.hasOwnProperty(attr)&&!e.hasOwnProperty(attr))return!1;return!0},randomHash:function(){return((1+Math.random())*65536|0).toString(16).substring(1)}},s.init()},e.fn.dynatable=function(t){return this.each(function(){if(undefined==e(this).data("dynatable")){var n=new e.dynatable(this,t);e(this).data("dynatable",n)}})}})(jQuery);