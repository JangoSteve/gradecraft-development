// Javascript UI for surveyor
jQuery(document).ready(function(){function e(e){return jQuery.each(e.show,function(){t(this)}),jQuery.each(e.hide,function(){n(this)}),jQuery.each(e.ids,function(e,t){jQuery("#r_"+e+"_question_id").after('<input id="r_'+e+'_id" type="hidden" value="'+t+'" name="r['+e+'][id]"/>')}),jQuery.each(e.remove,function(e,t){jQuery("#r_"+e+'_id[value="'+t+'"]').remove()}),!1}function t(e){group=e.match("^g_")?!0:!1,group?jQuery("#"+e).removeClass("g_hidden"):jQuery("#"+e).removeClass("q_hidden")}function n(e){group=e.match("^g_")?!0:!1,group?jQuery("#"+e).addClass("g_hidden"):jQuery("#"+e).addClass("q_hidden")}function r(e){$.blockUI.defaults.overlayCSS.opacity=0,$.blockUI.defaults.message=null,$.blockUI.defaults.fadeIn=0,$.blockUI.defaults.fadeOut=0,$.each(e,function(){$(this).block()})}function i(e){$.each(e,function(){$(this).unblock()})}jQuery("input[type='text'].datetime").datetimepicker({showSecond:!0,showMillisec:!1,timeFormat:"hh:mm:ss",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0}),jQuery("li.date input").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0}),jQuery("input[type='text'].date").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0}),jQuery("input[type='text'].datepicker").datepicker({dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0}),jQuery("input[type='text'].time").timepicker({}),jQuery(".surveyor_check_boxes input[type=text]").change(function(){var e=$(this).val();e.length>0&&($(this).parent().children().has('input[type="checkbox"]')[0].children[0].checked=!0)}),jQuery(".surveyor_radio input[type=text]").change(function(){var e=$(this).val();e.length>0&&($(this).parent().children().has('input[type="radio"]')[0].children[0].checked=!0)}),jQuery("form#survey_form input, form#survey_form select, form#survey_form textarea").change(function(){var t=[$('[type="submit"]').parent(),$('[name="'+this.name+'"]').closest("li")];r(t),question_data=$(this).parents('fieldset[id^="q_"],tr[id^="q_"]').find("input, select, textarea").add($("form#survey_form input[name='authenticity_token']")).serialize(),$.ajax({type:"PUT",url:$(this).parents("form#survey_form").attr("action"),data:question_data,dataType:"json",success:function(n){i(t),e(n)},error:function(e,n,r){i(t)}})}),jQuery("#dependents").remove(),$("input.exclusive:checked").parents('fieldset[id^="q_"]').find(":checkbox").not(".exclusive").attr("checked",!1).attr("disabled",!0),$("input.exclusive:checkbox").click(function(){var e=$(this),t=e.parents('fieldset[id^="q_"]').find(":checkbox").not(".exclusive");e.is(":checked")?t.attr("checked",!1).attr("disabled",!0):t.attr("disabled",!1)})});